@model IEnumerable<StartEvent.Web.Models.Celebrite>

@{
    ViewData["Title"] = "Célébrités";
    Layout = "_Layout";
    var hasAny = Model != null && Model.Any();
}

<section class="page-celebrites" style="padding:40px 0;">
    <div class="container" style="max-width:1200px;margin:0 auto;padding:0 20px;">

        <header style="display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;gap:12px;">
            <h1 style="margin:0;color:#800000;letter-spacing:1px;">Nos Célébrités</h1>

            <form method="get" asp-controller="Celebrites" asp-action="Index" style="display:flex;gap:8px;align-items:center;">
                <input type="text" name="q" value="@(Context.Request.Query["q"].ToString())"
                       placeholder="Rechercher (nom, profession, lieu)..." style="padding:10px;border-radius:6px;border:1px solid #ccc;min-width:220px;" />
                <button type="submit" style="padding:10px 14px;background:#800000;color:#fff;border:none;border-radius:6px;">Rechercher</button>
                <a href="@Url.Action("Index","Celebrites")" style="padding:10px 12px;background:#f0f0f0;color:#333;border-radius:6px;text-decoration:none;border:1px solid #ddd;margin-left:6px;">Effacer</a>
            </form>
        </header>

        @if (!hasAny)
        {
            <div style="padding:40px;text-align:center;color:#666;">
                <p>Aucune célébrité trouvée.</p>
            </div>
        }
        else
        {
            <div class="celebrite-grid" style="display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:20px;">
                @foreach (var c in Model!)
                {
					var photoUrl = (!string.IsNullOrWhiteSpace(c.PhotoPath) && (c.PhotoPath.StartsWith("http") || c.PhotoPath.StartsWith("https")))
						? c.PhotoPath
						: Url.Content("~/" + (string.IsNullOrWhiteSpace(c.PhotoPath) ? "images/logo.png" : c.PhotoPath.TrimStart('/')));
                    <article class="celebrite-card" style="border:1px solid #e6e6e6;border-radius:12px;padding:12px;text-align:center;background:#fff;box-shadow:0 4px 14px rgba(0,0,0,0.03);">
						<img src="@photoUrl" alt="@c.Nom" style="width:100%;height:220px;object-fit:cover;border-radius:8px 8px 4px 4px;" onerror="this.onerror=null;this.src='@Url.Content("~/images/logo.png")';" />
                        <h3 style="margin:12px 0 6px 0;font-size:1.05rem;">@c.Nom</h3>
                        @if (!string.IsNullOrWhiteSpace(c.Profession))
                        {
                            <p style="margin:0 0 8px 0;color:#666;font-size:.95rem;">@c.Profession</p>
                        }
                        <a asp-controller="Celebrites" asp-action="Details" asp-route-id="@c.Id" class="btn-profile" style="display:inline-block;margin-top:10px;padding:8px 12px;border-radius:8px;background:#800000;color:#fff;text-decoration:none;">Voir le profil</a>
                    </article>
                }
            </div>
        }
    </div>
</section>

@section Scripts {
    <script>
        // Optionnel : filtrage instantané côté client (améliore UX mais conserve la recherche serveur)
        (function () {
            const input = document.querySelector('input[name="q"]');
            if (!input) return;
            input.addEventListener('input', function () {
                const q = this.value.trim().toLowerCase();
                const cards = document.querySelectorAll('.celebrite-card');
                if (!q) {
                    cards.forEach(c => c.style.display = '');
                    return;
                }
                cards.forEach(c => {
                    const name = (c.querySelector('h3')?.textContent || '').toLowerCase();
                    const prof = (c.querySelector('p')?.textContent || '').toLowerCase();
                    if (name.includes(q) || prof.includes(q)) c.style.display = '';
                    else c.style.display = 'none';
                });
            });
        })();
    </script>
}